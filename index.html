<!DOCTYPE html>
<html lang="en-US">
<head>
  <title>A-Frame Super Shooter Kit - Basic</title>
  <meta charset="utf-8">
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
</head>

<body>
  <a-scene background="color: #DADADA">
    <a-assets>
      <img id="grid" src="1.png">
    </a-assets>

    <a-plane id="ground" src="#grid" transparent="true" rotation="-90 0 0" width="100" height="100"></a-plane>

    <!-- Add targets dynamically -->
    <script>
      AFRAME.registerComponent('random-movement', {
        init: function () {
          const ground = document.querySelector('#ground');
          const groundWidth = ground.getAttribute('width');
          const groundHeight = ground.getAttribute('height');
          const minX = -groundWidth / 2;
          const maxX = groundWidth / 2;
          const minZ = -groundHeight / 2;
          const maxZ = groundHeight / 2;

          // Randomly move the entity within boundaries
          this.el.object3D.position.x = Math.random() * (maxX - minX) + minX;
          this.el.object3D.position.z = Math.random() * (maxZ - minZ) + minZ;

          // Animate the entity's position continuously
          this.el.addEventListener('componentchanged', (evt) => {
            if (evt.detail.name === 'position') {
              // Generate new random position if the entity reaches the boundary
              if (
                this.el.object3D.position.x <= minX ||
                this.el.object3D.position.x >= maxX ||
                this.el.object3D.position.z <= minZ ||
                this.el.object3D.position.z >= maxZ
              ) {
                this.el.object3D.position.x = Math.random() * (maxX - minX) + minX;
                this.el.object3D.position.z = Math.random() * (maxZ - minZ) + minZ;
              }
            }
          });
        }
      });

      // Create targets dynamically
      for (let i = 0; i < 5; i++) {
        const target = document.createElement('a-entity');
        target.setAttribute('class', 'target');
        target.setAttribute('geometry', 'primitive: box');
        target.setAttribute('material', 'color: red');
        target.setAttribute('position', '0 0 -4');
        target.setAttribute('random-movement', '');
        document.querySelector('a-scene').appendChild(target);
      }
    </script>

    <!-- Lights -->
    <a-entity light="type: ambient; color: #CCC; intensity: 0.5" rotation="-90 0 0"></a-entity>
    <a-entity light="type: directional; color: white; intensity: 5; position: -0.5 1 1"></a-entity>

    <!-- Camera with aerial view -->
    <a-camera position="0 50 0" rotation="-90 0 0"></a-camera>
  </a-scene>
</body>
</html>
